<app-body>
  <div class="row text-center">
    <div class="col-md-12 my-3">
      <app-card>
        <ng-container *ngIf="ready; else loading">
          <section id="header">
            <h2>{{blockDeck.title}} - {{mode.title}}</h2>
            <div class="row justify-content-center">
              <div class="col-md-2">
                <app-modal-trigger-button [boxId]="'rule-basics'">
                  Rule Basics
                </app-modal-trigger-button>
              </div>
              <div class="col-md-2">
                <app-modal-trigger-button [boxId]="'block-list'">
                  Block List
                </app-modal-trigger-button>
              </div>
            </div>
          </section>
          <hr>
          <section id="rules">
            <h4>
              Rules
            </h4>
            <ul class="list-group">
              <li class="list-group-item">
                Standard Penalty: {{mode.standardPenalty}}
              </li>
              <li class="list-group-item">
                Tower Fall Penalty:
                {{mode.towerFallPenalty}}
              </li>
              <li class="list-group-item" *ngIf="blockDeck.deckRule">
                Deck Rule: {{blockDeck.deckRule}}
              </li>
              <li class="list-group-item" *ngFor="let extraRule of mode.extraRules">
                {{extraRule}}
              </li>
            </ul>
          </section>
          <hr>
          <section id="block-select">
            <div class="row">
              <div class="col-md-4 my-2">
                <div class="card card-body bg-dark">
                  <div class="input-group">
                    <input
                      type="number"
                      class="form-control"
                      name="selectedBlockNumber"
                      [(ngModel)]="nextBlockNumber"
                      id="blockNumber"
                      placeholder="Block Number"
                      aria-label="Block Number"
                      aria-describedby="button-addon"
                    />
                    <div class="input-group-append" (click)="selectBlock()">
                      <button
                        class="btn btn-outline-light"
                        type="submit"
                        id="button-addon"
                      >
                <span>
                  <i class="fa fa-arrow-right"></i>
                </span>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-8 my-2">
                <div class="card card-body bg-dark text-light" *ngIf="incorrectSelection">
                  <div class="alert alert-warning">
                    <h4>
                      Invalid Number
                    </h4>
                    <hr>
                    <p>
                      Please enter a number between 1 and {{blockDeck.blocks.length}}.
                    </p>
                  </div>
                </div>
                <div class="card card-body bg-dark text-light" *ngIf="selectedBlock">
                  <h4>
                <span *ngIf="selectedBlockNumber">
                  Block {{selectedBlockNumber}}:
                </span>
                    {{selectedBlock.title}}
                  </h4>
                  <hr>
                  <p>
                    {{selectedBlock.rule}}
                  </p>
                </div>
                <div class="card card-body bg-dark text-light" *ngIf="!selectedBlock && !incorrectSelection">
                  <h4>
                    Welcome!
                  </h4>
                  <hr>
                  <p>
                    Pull a block and enter the number on it to begin.
                  </p>
                </div>
              </div>
            </div>
          </section>

          <section id="modals">
            <app-modal-box-basic [boxId]="'rule-basics'" [title]="'Rule Basics'">
              <p>
                Take the STANDARD PENALTY when you want to skip a block rule, when you fail to complete a block rule,
                or when a block gives you any number of penalties.
              </p>
              <p>
                Take the TOWER FALL PENALTY when you cause the tower to fall over, whether it is your turn or not.
              </p>
            </app-modal-box-basic>
            <app-modal-box-basic [boxId]="'block-list'" [title]="'Block List'">
              <ul class=" list-group">
                <ng-container *ngFor="let block of blockDeck.blocks; let i = index">
                  <li class="list-group-item">
                    <span class="pull-left">{{i + 1}})</span>
                    {{block.title}}
                  </li>
                </ng-container>
              </ul>
            </app-modal-box-basic>
          </section>
        </ng-container>
      </app-card>
    </div>
  </div>
</app-body>

<ng-template #loading>
  <app-loading></app-loading>
</ng-template>
